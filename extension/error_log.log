Delta matrix shape: torch.Size([93, 4096])
  N (num prompts): 93
  d (model dim): 4096

Performing PCA with 10 components...
Loading original refusal direction from: pipeline/runs/yi-6b-chat/direction.pt

============================================================
PCA Analysis Results
============================================================

Number of components: 10
Total variance explained: 65.91%

Variance explained by each component:
----------------------------------------
  PC1:  44.94% (cumulative:  44.94%)
  PC2:   4.21% (cumulative:  49.15%)
  PC3:   3.40% (cumulative:  52.55%)
  PC4:   2.79% (cumulative:  55.35%)
  PC5:   2.21% (cumulative:  57.55%)
  PC6:   1.99% (cumulative:  59.54%)
  PC7:   1.86% (cumulative:  61.40%)
  PC8:   1.65% (cumulative:  63.05%)
  PC9:   1.52% (cumulative:  64.58%)
  PC10:   1.33% (cumulative:  65.91%)

Component norms (should be ~1):
  PC1: 1.0000
  PC2: 1.0000
  PC3: 1.0000
  PC4: 1.0000
  PC5: 1.0000
  PC6: 1.0000
  PC7: 1.0000
  PC8: 1.0000
  PC9: 1.0000
  PC10: 1.0000

----------------------------------------
Alignment with original refusal direction:
----------------------------------------
Traceback (most recent call last):
  File "/workspace/refusal_direction/extension/pca_delta_directions.py", line 177, in <module>
    main()
  File "/workspace/refusal_direction/extension/pca_delta_directions.py", line 156, in main
    analyze_directions(pca_results, original_direction)
  File "/workspace/refusal_direction/extension/pca_delta_directions.py", line 90, in analyze_directions
    cosine_sim = torch.dot(orig_dir_normalized, comp_normalized).item()
RuntimeError: Expected all tensors to be on the same device, but got tensor is on cpu, different from other tensors on cuda:0 (when checking argument in method wrapper_CUDA__dot)
(refusal) root@C.30500889:/workspace/refusal_direction$ 